<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Frame Wars : A 4‑Player Guess The Frame Game</title>
  <style>
    :root{ --bg:#0b1020;--card:#121935;--muted:#93a1c6;--text:#eaf0ff;--accent:#6ae3ff;--good:#2dd4bf;--bad:#f87171;--primary:#8b5cf6; }
    *{box-sizing:border-box} html,body{height:100%}
    body{margin:0;font-family:ui-sans-serif,system-ui,Segoe UI,Roboto,Helvetica,Arial,Apple Color Emoji,Segoe UI Emoji;background:radial-gradient(1200px 800px at 80% -10%, #1d2758 0%, #0b1020 55%);}    
    a{color:var(--accent)}
    .wrap{max-width:1200px;margin:0 auto;padding:20px 16px 80px;color:var(--text)}
    .card{background:linear-gradient(180deg,rgba(255,255,255,.06),rgba(255,255,255,.03)); border:1px solid rgba(255,255,255,.08); border-radius:18px; box-shadow:0 10px 30px rgba(0,0,0,.35)}
    header{display:flex;align-items:center;justify-content:space-between;gap:12px}
    .title{display:flex;align-items:center;gap:10px}
    .title h1{margin:0;font-size:20px;letter-spacing:.2px}
    .title .pill{font-size:12px;background:rgba(255,255,255,.08);padding:4px 10px;border-radius:999px;border:1px solid rgba(255,255,255,.1);color:var(--muted)}
    .grid{display:grid;gap:14px}
    .grid.cols-2{grid-template-columns:320px 1fr}
    @media (max-width:900px){.grid.cols-2{grid-template-columns:1fr}}
    .pane{padding:16px}
    .pane h2{margin:0 0 8px;font-size:16px;color:var(--muted);font-weight:600}
    .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
    button{appearance:none;border:0;border-radius:14px;padding:12px 16px;font-weight:700;letter-spacing:.2px;cursor:pointer;color:#0b1020;background:linear-gradient(180deg,#8b5cf6,#5b21b6);box-shadow:0 8px 20px rgba(91,33,182,.45)}
    button.ghost{background:transparent;color:var(--text);border:1px solid rgba(255,255,255,.15)}
    button.flat{background:#1e293b;color:#e5edff;border:1px solid rgba(255,255,255,.08)}
    button.bad{background:linear-gradient(180deg,#f87171,#dc2626)}
    .badge{padding:4px 8px;border-radius:999px;background:rgba(255,255,255,.08);border:1px solid rgba(255,255,255,.12);font-size:12px;color:var(--muted)}
    .players{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:10px}
    @media (min-width:900px){.players{grid-template-columns:repeat(2,minmax(0,1fr))}}
    .p-card{padding:12px;border-radius:14px;background:linear-gradient(180deg,rgba(255,255,255,.05),rgba(255,255,255,.02));border:1px solid rgba(255,255,255,.08);position:relative}
    .p-card .name{font-weight:700}
    .p-card .score{font-size:28px;font-weight:800}
    .p-card.umpire{outline:2px dashed var(--accent);}
    .question{display:flex;flex-direction:column;gap:10px}
    .q-view{position:relative;background:#0a0f25;border:1px solid rgba(255,255,255,.08);border-radius:14px;overflow:hidden;min-height:60vh;display:flex;align-items:center;justify-content:center}
    .q-view img{max-width:100%;max-height:75vh;display:block;transition:filter .2s ease}
    .q-view.blurred img{filter:blur(16px) brightness(.75)}
    .q-view .cover{position:absolute;inset:0;display:grid;place-items:center;color:#cfe3ff;font-weight:800;background:rgba(11,16,32,.25);backdrop-filter:blur(2px)}
    .watermark{position:absolute;inset:auto 12px 12px auto;font-size:11px;opacity:.55}
    .mini{font-size:11px;color:var(--muted)}
    .sep{height:1px;background:rgba(255,255,255,.08);margin:12px 0}
    .footer{position:fixed;left:0;right:0;bottom:0;padding:10px 16px;background:linear-gradient(180deg, rgba(11,16,32,0), rgba(11,16,32,.85));backdrop-filter:blur(6px);}
    .footer .inner{max-width:1200px;margin:0 auto;display:flex;align-items:center;gap:10px;justify-content:space-between}
    .hidden{display:none}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="title">
        <h1><strong>Frame Wars</strong> : <span class="dim">A 4‑Player Guess The Frame Game</span></h1>
        <span class="pill">+10p player | +15p umpire</span>
      </div>
      <div class="row">
        <button class="flat" id="howBtn">How it works</button>
        <button class="ghost" id="settingsBtn" title="Edit players, rotation">Settings</button>
      </div>
    </header>

    <div class="grid cols-2" id="setupView">
      <section class="card pane">
        <h2>Players</h2>
        <div class="players" id="playersForm"></div>
        <div class="sep"></div>
        <div class="row">
          <label class="badge">Umpire rotation</label>
          <div class="pill-sel" id="rotationSel"></div>
        </div>
        <div class="row" style="margin-top:12px">
          <button id="startBtn">Start game</button>
        </div>
      </section>
      <section class="card pane">
        <h2>Rounds</h2>
        <div class="list" id="roundList"></div>
      </section>
    </div>

    <section id="gameView" class="hidden">
      <div class="grid cols-2">
        <div class="card pane">
          <h2>Round</h2>
          <div class="row" style="justify-content:space-between">
            <div>
              <div class="badge">Category</div>
              <div style="font-size:20px;font-weight:800" id="roundName">—</div>
              <div class="mini" id="qProgress">Q — / —</div>
            </div>
          </div>
          <div class="row" style="margin-top:8px">
            <button class="warn" id="startQBtn">Start</button>
            <button class="ghost" id="revealBtn">Reveal answer</button>
          </div>
          <div class="sep"></div>
          <h2>Players & Buzz</h2>
          <div class="players" id="scoreBoard"></div>
          <div class="sep"></div>
          <div id="buzzBar"></div>
          <div class="row" style="margin-top:10px;align-items:center;gap:12px">
            <div class="badge">Award points</div>
            <button class="flat" id="umpireCorrectBtn">Umpire got it (+15)</button>
            <button class="bad" id="skipBtn">Skip</button>
          </div>
          <div class="row" style="margin-top:10px">
            <button id="prevBtn" class="ghost">◀ Prev</button>
            <button id="nextBtn">Next ▶</button>
          </div>
        </div>

        <div>
          <div class="card pane question">
            <div class="q-view blurred" id="qView">
              <div class="qtext dim">Press Start to show clearly</div>
              <div class="watermark">Umpire: <span id="umpireTag">—</span></div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section id="endView" class="hidden">
      <div class="card pane">
        <h2>Final Leaderboard</h2>
        <div class="players" id="finalBoard"></div>
        <div class="row" style="margin-top:12px">
          <button id="playAgainBtn">Play again</button>
          <button class="flat" id="backHomeBtn">Back to setup</button>
        </div>
      </div>
    </section>

    <div class="footer">
      <div class="inner mini">Made for GitHub Pages · Scores auto‑save to your browser</div>
    </div>
  </div>

  <script>
  const $ = s => document.querySelector(s);
  const $$ = s => Array.from(document.querySelectorAll(s));
  const store = {
    players:[{name:'Player 1',score:0},{name:'Player 2',score:0},{name:'Player 3',score:0},{name:'Player 4',score:0}],
    rotation:'auto', qPerRound:7, rounds:[], cur:{roundIdx:0,qIdx:0,umpireIdx:0,isBlurred:true}
  };

  function save(){ localStorage.setItem('gtf_state_v1', JSON.stringify({players:store.players, rotation:store.rotation, qPerRound:store.qPerRound, rounds:store.rounds})); }
  function load(){ const raw=localStorage.getItem('gtf_state_v1'); if(raw){ try{ const data=JSON.parse(raw); Object.assign(store, data); }catch(e){} } }

  function renderSetup(){
    $('#setupView').classList.remove('hidden'); $('#gameView').classList.add('hidden'); $('#endView').classList.add('hidden');
    const pf=$('#playersForm'); pf.innerHTML='';
    store.players.forEach((p,i)=>{ const d=document.createElement('div'); d.className='p-card'; d.innerHTML=`<div class="row"><span class="badge">P${i+1}</span></div><input type="text" value="${p.name}" data-idx="${i}" class="nameInput"/>`; pf.appendChild(d); });
    pf.querySelectorAll('.nameInput').forEach(inp=> inp.addEventListener('input', e=>{ const i=+inp.dataset.idx; store.players[i].name=inp.value; save(); renderScore(); renderBuzzbar(); }));
    const rot=$('#rotationSel'); rot.innerHTML=''; ['auto','manual'].forEach(r=>{ const b=document.createElement('button'); b.className='flat'+(store.rotation===r?' active':''); b.textContent=r; b.onclick=()=>{store.rotation=r; save(); renderRotationSel();}; rot.appendChild(b); });
    renderRotationSel();
    const rl=$('#roundList'); rl.innerHTML=''; store.rounds.forEach((r,ri)=>{ const it=document.createElement('div'); it.className='item'; it.innerHTML=`<div class="item-head"><div><strong>${ri+1}. ${r.name}</strong> <span class="badge">${r.type}</span></div><div class="mini">${r.items.length} items</div></div>`; rl.appendChild(it); });
  }
  function renderRotationSel(){ $$('#rotationSel button').forEach(b=> b.classList.remove('active')); $$('#rotationSel button').find(b=> b.textContent===store.rotation)?.classList.add('active'); }
  function initGame(){ store.cur.roundIdx=0; store.cur.qIdx=0; store.cur.umpireIdx=0; store.players.forEach(p=>p.score=0); save(); renderGame(); }
  function renderGame(){ $('#setupView').classList.add('hidden'); $('#gameView').classList.remove('hidden'); $('#endView').classList.add('hidden'); const r=store.rounds[store.cur.roundIdx]; $('#roundName').textContent=`${store.cur.roundIdx+1}. ${r.name}`; $('#umpireTag').textContent=store.players[store.cur.umpireIdx].name; const totalQ=Math.min(store.qPerRound, r.items.length); $('#qProgress').textContent=`Q ${Math.min(store.cur.qIdx+1,totalQ)} / ${totalQ}`; renderQuestion(); renderScore(); renderBuzzbar(); }
  function renderScore(){ const sb=$('#scoreBoard'); sb.innerHTML=''; store.players.forEach((p,i)=>{ const d=document.createElement('div'); d.className='p-card'+(i===store.cur.umpireIdx?' umpire':''); d.innerHTML=`<div class="name">${p.name}</div><div class="score">${p.score}</div>`; sb.appendChild(d); }); const fb=$('#finalBoard'); if(fb){ fb.innerHTML=''; [...store.players].sort((a,b)=>b.score-a.score).forEach(p=>{ const d=document.createElement('div'); d.className='p-card'; d.innerHTML=`<div class="name">${p.name}</div><div class="score">${p.score}</div>`; fb.appendChild(d); }); } }
  function renderBuzzbar(){ const bb=$('#buzzBar'); bb.innerHTML=''; store.players.forEach((p,i)=>{ if(i===store.cur.umpireIdx) return; const b=document.createElement('button'); b.className='flat'; b.textContent=`✔ ${p.name} (+10)`; b.onclick=()=>awardPlayer(i,10); bb.appendChild(b); }); }
  function renderQuestion(){ const r=store.rounds[store.cur.roundIdx]; const items=r.items; const totalQ=Math.min(store.qPerRound, items.length); const idx=Math.min(store.cur.qIdx, totalQ-1); const q=items[idx]; const view=$('#qView'); view.classList.add('blurred'); view.innerHTML=''; if(r.type==='text'){ const el=document.createElement('div'); el.className='qtext'; el.textContent=q.text||'(no text)'; view.appendChild(el); } else { const img=document.createElement('img'); img.src=q.imageUrl||''; view.appendChild(img); } const wm=document.createElement('div'); wm.className='watermark'; wm.innerHTML=`Umpire: <span id="umpireTag">${store.players[store.cur.umpireIdx].name}</span>`; view.appendChild(wm); const cover=document.createElement('div'); cover.className='cover'; cover.textContent='Blurred — Press Start'; view.appendChild(cover); store.cur.isBlurred=true; }
  function nextQuestion(){ const r=store.rounds[store.cur.roundIdx]; const totalQ=Math.min(store.qPerRound, r.items.length); if(store.cur.qIdx<totalQ-1){ store.cur.qIdx++; renderGame(); } else { nextRound(); } }
  function prevQuestion(){ if(store.cur.qIdx>0){ store.cur.qIdx--; renderGame(); } }
  function nextRound(){ if(store.cur.roundIdx<store.rounds.length-1){ store.cur.roundIdx++; store.cur.qIdx=0; if(store.rotation==='auto'){ store.cur.umpireIdx=(store.cur.umpireIdx+1)%store.players.length; } renderGame(); } else { endGame(); } }
  function endGame(){ $('#setupView').classList.add('hidden'); $('#gameView').classList.add('hidden'); $('#endView').classList.remove('hidden'); renderScore(); save(); }
  function awardPlayer(i,pts){ if(i===store.cur.umpireIdx) return; store.players[i].score+=pts; save(); renderScore(); }
  function awardUmpire(pts){ store.players[store.cur.umpireIdx].score+=pts; save(); renderScore(); }

  $('#howBtn').onclick=()=>alert('Players take turns guessing the blurred image.');
  $('#settingsBtn').onclick=()=>alert('Edit players or umpire rotation before starting.');
  $('#startBtn').onclick=initGame;
  $('#startQBtn').onclick=()=>$('#qView').classList.remove('blurred');
  $('#revealBtn').onclick=()=>alert('Reveal the correct answer.');
  $('#prevBtn').onclick=prevQuestion;
  $('#nextBtn').onclick=nextQuestion;
  $('#skipBtn').onclick=nextQuestion;
  $('#umpireCorrectBtn').onclick=()=>awardUmpire(15);

